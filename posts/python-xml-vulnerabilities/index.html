<!doctype html><html lang=zh-TW><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.121.2"><title>python xml vulnerabilities | Ryan's blog </title><link rel=stylesheet href=https://blog.cwc.tw/css/simpleness.css><link rel=canonical href=https://blog.cwc.tw/posts/python-xml-vulnerabilities/><link rel=alternate type=application/rss+xml href title="Ryan's blog"><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css rel=stylesheet></head><body class=container><nav class=navigation><div class=nav-left><div class="nav-item nav-title"><a href=https://blog.cwc.tw/>Ryan's blog</a></div><div class="nav-item nav-menu"><a href=/categories/coding>Coding</a>
<a href=/categories/hiking>Hiking</a></div></div><div class="nav-item nav-right fontawesome"><a href=https://twitter.com/v_kiiii target=_blank><i title=Twitter class="fab fa-twitter"></i>
</a><a href=https://github.com/ryanchentw target=_blank><i title=GitHub class="fab fa-github"></i></a></div></nav><article class=post><header class=post-header><h1 style=text-align:center>python xml vulnerabilities</h1><div class=post-metadata><time datetime=2017-03-13T18:00:32+08:00>March 13, 2017</time> &nbsp;
<i class="fas fa-folder"></i>
<a href=/categories/coding>coding</a>
&nbsp;</div></header><div class=post-text><blockquote><p>It&rsquo;s just XML, what could probably go wrong? - Christian Heimes</p></blockquote><p>And &mldr;</p><blockquote><p>XML is crap. Really. There are no excuses. XML is nasty to parse for humans, and it&rsquo;s a disaster to parse even for computers. There&rsquo;s just no reason for that horrible crap to exist. - Linus Trovalds</p></blockquote><h1 id=issue>Issue</h1><p>最近 review 公司的一些外部服務的 callback api 的安全性。</p><p>其中一個 api 交換資訊使用 xml 格式傳送，而 parse 時用 Python standard library 的 xml module</p><p><a href=https://docs.python.org/2/library/xml.html#xml-vulnerabilities>而 xml module 有一些安全性上的弱點</a></p><p>用 <a href=https://en.wikipedia.org/wiki/Billion_laughs>wiki 的 billion laughs</a> sample code 當 payload 測試果然掛了，</p><p>充滿惡意的憤青們可以只用一台電腦癱瘓掉家裡所有 web node，</p><p>不過因為有鎖 ip ，所以也不是一個嚴重的安全性問題，廠廠。</p><h1 id=solutions>Solutions</h1><p>看到問題後第一想法是不要用 xml module 處理，改用 lxml 之類的 3rd party lib</p><p>後來想想這問題應該滿普遍的，應該會有其他解法可以考慮。</p><p>期望可以有 Monkey Patch 或是至少提供相同 API 讓 migration 變得容易</p><p>問 Google 老師找到 <a href=https://github.com/tiran/defusedxml>defusedxml</a> 專案看起來有八成七像</p><p>提供了相同 API，在 xmlrpc 部分是用 monkey patch，可以無痛轉換。</p><h1 id=case-closed>Case closed</h1><p>基本上在一個後 json 時代講 xml 實用性實在不高，不過人在江湖走跳，</p><p>難免介接利用其他第三方服務，尤其是銀行業仍偏好使用 xml，</p><p>在 parse 的時候還是需要注意是否會產生類似安全性問題。</p><p>Bomb has benn defused, counter terrorists win!</p><p><em><strong>btw 找不到開頭引言的來源，所以確實 Python developer 曾經講過這句話，然後在 repo 被公開處刑？</strong></em></p></div><footer class=post-footer><div class=post-tags><i class="fas fa-tags"></i>
<a href=/tags/python>Python</a>
&nbsp;
<a href=/tags/xml>xml</a>
&nbsp;</div></footer><div class=comments><div class=comments><div class="comments-item comments-disqus"><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var e=document,t=e.createElement("script");t.src="https://prpr-tw.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()})</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></div></article><div class=foot>&copy; - 2024 &#183;
<a href=/>Ryan's blog </a>&#183;
Theme <a href=https://github.com/RainerChiang/simpleness>Simpleness</a> Powered by <a href=https://gohugo.io/>Hugo</a> &#183;
<a href=#><i class="fas fa-chevron-up"></i></a></div></body></html>